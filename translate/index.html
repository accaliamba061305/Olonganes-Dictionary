<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Olonganes Translator</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      transition: background 0.4s, color 0.4s;
    }
    /* Default: Black on White */
    body {
      background: #ffffff;
      color: #000000;
    }
    body.contrast-white-on-black {
      background: #000000;
      color: #ffffff;
    }
    body.contrast-yellow-on-black {
      background: #000000;
      color: #ffff00;
    }
    /* Các phần tử khác điều chỉnh theo contrast */
    body.contrast-white-on-black header,
    body.contrast-yellow-on-black header {
      background: #111111;
    }
    body.contrast-white-on-black .back,
    body.contrast-yellow-on-black .back {
      color: #ffffff;
    }
    body.contrast-white-on-black textarea,
    body.contrast-yellow-on-black textarea {
      background: #111111;
      color: inherit;
      border-color: #555;
    }
    body.contrast-white-on-black #output,
    body.contrast-yellow-on-black #output {
      background: #111111;
      border-color: #555;
    }
    body.contrast-white-on-black .suggestions,
    body.contrast-yellow-on-black .suggestions {
      background: #222;
      border-color: #555;
    }
    body.contrast-white-on-black .suggestions li,
    body.contrast-yellow-on-black .suggestions li {
      color: #ffffff;
    }
    body.contrast-white-on-black .char-count,
    body.contrast-yellow-on-black .char-count {
      color: #aaa;
    }
    /* Các style còn lại giữ nguyên, thêm nếu cần */
    header { background: #2196F3; color: white; padding: 15px; text-align: center; position: relative; }
    header h1 { margin: 0; font-size: 1.8em; }
    .settings-icon { position: absolute; right: 20px; top: 18px; font-size: 1.5em; cursor: pointer; color: white; }
    .settings-panel { display: none; position: fixed; top: 60px; right: 20px; background: white; border: 1px solid #ccc; border-radius: 8px; padding: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 1000; width: 220px; }
    body.contrast-white-on-black .settings-panel,
    body.contrast-yellow-on-black .settings-panel { background: #222; color: white; border-color: #555; }
    .settings-panel label { display: block; margin: 10px 0; cursor: pointer; }
    .settings-panel input[type="radio"] { margin-right: 8px; }
  </style>
</head>
<body>
  <header>
    <h1>Olonganes Translator</h1>
    <a href="../" class="back">← Back to Dictionary</a>
    <span class="settings-icon" id="settingsIcon">⚙️</span>
  </header>

  <!-- Settings Panel -->
  <div class="settings-panel" id="settingsPanel">
    <h3>Contrast</h3>
    <label><input type="radio" name="contrast" value="black-on-white" checked> Black on White</label>
    <label><input type="radio" name="contrast" value="white-on-black"> White on Black</label>
    <label><input type="radio" name="contrast" value="yellow-on-black"> Yellow on Black</label>
  </div>

  <main>
    <div class="lang-select">
      <select id="fromLang">
        <option value="en">English</option>
        <option value="ol">Olonganes</option>
      </select>
      <button class="swap-btn" id="swapBtn">↔</button>
      <select id="toLang">
        <option value="ol">Olonganes</option>
        <option value="en">English</option>
      </select>
    </div>

    <div class="input-wrapper">
      <textarea id="input" placeholder="Nhập từ hoặc cụm từ cần dịch..."></textarea>
      <button class="clear-btn" id="clearBtn">×</button>
      <div class="char-count" id="charCount">0 / 5000</div>
      <ul class="suggestions" id="suggestions"></ul>
    </div>

    <div id="loading">Đang tra cứu...</div>

    <div id="output">Kết quả dịch sẽ hiện ở đây...</div>

    <div class="actions">
      <button id="copyBtn">Copy kết quả</button>
    </div>
  </main>

  <script>
    // Load dictionary (giữ nguyên từ trước)
    let dictionary = [];
    fetch('../dictionary.json')
      .then(res => res.json())
      .then(data => { dictionary = data; console.log('Loaded', dictionary.length); })
      .catch(err => { console.error(err); document.getElementById('output').innerHTML = '<span class="not-found">Lỗi load từ điển!</span>'; });

    // ... (giữ nguyên các biến và event cho lang, swap, input, suggestions, auto translate, copy, clearBtn như code trước)

    // PHẦN CONTRAST / SETTINGS
    const settingsIcon = document.getElementById('settingsIcon');
    const settingsPanel = document.getElementById('settingsPanel');
    const contrastRadios = document.querySelectorAll('input[name="contrast"]');

    // Toggle panel
    settingsIcon.addEventListener('click', () => {
      settingsPanel.style.display = settingsPanel.style.display === 'block' ? 'none' : 'block';
    });

    // Apply contrast
    function applyContrast(mode) {
      document.body.classList.remove('contrast-white-on-black', 'contrast-yellow-on-black');
      if (mode === 'white-on-black') {
        document.body.classList.add('contrast-white-on-black');
      } else if (mode === 'yellow-on-black') {
        document.body.classList.add('contrast-yellow-on-black');
      }
      // Lưu localStorage (key giống từ điển, giả định là 'contrastMode' - nếu khác thì sửa)
      localStorage.setItem('contrastMode', mode);
    }

    // Load từ localStorage khi mở page
    const savedMode = localStorage.getItem('contrastMode') || 'black-on-white';
    applyContrast(savedMode);
    document.querySelector(`input[value="${savedMode}"]`).checked = true;

    // Khi chọn radio
    contrastRadios.forEach(radio => {
      radio.addEventListener('change', () => {
        applyContrast(radio.value);
      });
    });

    // ... (phần còn lại của script: input event, debounce, suggestions filter, translateAuto, etc. paste từ code cũ vào đây)
  </script>
</body>
</html>
